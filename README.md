# ethereum_validator_schedule
```markdown
# Ethereum 2.0 Proposer Duties Exporter

This Python script fetches Ethereum 2.0 beacon chain proposer duties over a range of epochs and exports them into a CSV file. It supports concurrent fetching using threads and displays progress using a dynamic progress bar.

## ğŸ§° Features

- Concurrent API requests for faster data fetching
- Rate-limited to avoid overloading endpoints
- Dynamic progress bar with estimated time remaining
- CSV export with standardized structure

## ğŸ“¦ Requirements

Make sure the following packages are installed:

```bash
pip install requests tqdm
```

Python 3.7 or higher is recommended.

## âš™ï¸ Usage

Update the `start_epoch` and `end_epoch` in the script or modify to accept command-line arguments.

Then run the script with:

```bash
python main_validator_schedule_extraction.py
```

### ğŸ–¥ï¸ Example

```python
start_epoch = 356160
end_epoch = 359330
export_proposer_duties(start_epoch, end_epoch)
```

This will create a CSV file named `proposer_duties_356160_to_359330.csv`.

## ğŸ“„ Output Format

The output CSV contains the following columns:

- `Epoch`
- `Slot`
- `Validator Index`
- `Public Key`


### `missing_epochs_list.py`

Reads the exported proposer duties CSV and identifies missing epochs that were not successfully fetched.

#### ğŸ”¹ Output:
- Prints or saves a list of missing epochs
- Useful for recovery or re-fetching failed data points

---

### `missing_epoch_data_extraction.py`

Uses the missing epochs list (generated by `missing_epochs_list.py`) to re-fetch proposer duties only for those epochs and appends them to a new or existing CSV.

#### ğŸ”¹ Use Case:
- Recovery tool to fill in gaps in the original export
- Uses the same endpoint and format as the main fetch script

---

### `dunequery_to_csv.py`

Fetches the latest result of a Dune Analytics query and exports it to CSV.

#### ğŸ”¹ Requirements:
- Dune API key
- Public or authorized query ID

#### ğŸ§ª Example:
```python
from dune_client.client import DuneClient

dune = DuneClient("your_dune_api_key")
query_result = dune.get_latest_result(query_id)
```

#### ğŸ”¹ Output:
- CSV file containing the full query result set with headers

---

## ğŸ”§ Setup

Install dependencies:

```bash
pip install requests tqdm dune-client
```

For security, store sensitive info like your Dune API key in environment variables.

---

## ğŸ“Œ Notes on API usage

- The script uses a QuikNode Beacon API endpoint; update it with your own if needed.
- The default `max_workers` is 15. Adjust based on your API rate limits.
- Add environment variable or config support for endpoint URLs if scaling.
- For Dune, be sure your query is published and accessible via your API key.

## ğŸš§ Error Handling

- Basic request exceptions are caught and logged.
- Failed epochs are skipped and can be retried by running the missing_epochs_data_extraction.py file.
